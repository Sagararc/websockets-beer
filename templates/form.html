<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <title>Bootstrap demo</title>
        <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-T3c6CoIi6uLrA9TneNEoa7RxnatzjcDSCmG1MXxSR1GAsXEV/Dwwykc2MPK8M2HN" crossorigin="anonymous">
      </head>
<body>
    
<h1>ABI Digital Activation</h1>

<form id="contactForm">
    <div class="input-group mb-3">
        <span class="input-group-text" id="inputGroup-sizing-default">Name</span>
        <input type="text" class="form-control" aria-label="Sizing example input" aria-describedby="inputGroup-sizing-default">
      </div>


      <div class="input-group mb-3">
        <span class="input-group-text" id="inputGroup-sizing-default">Song</span>
        <input type="text" class="form-control" aria-label="Sizing example input" aria-describedby="inputGroup-sizing-default">
      </div>
    
    
    <input type="submit" value="Submit">
</form>

<div id="displayData"></div>

<script>
    var ws = new WebSocket('ws://170.187.237.51:8001/ws/contact/');

    ws.onopen = function () {
        console.log('Websocket connection open...')
        ws.send(JSON.stringify({ 'message': "Hi this is from developer's side.." }));
    }
    
    document.getElementById('contactForm').addEventListener('submit', function(event) {
        event.preventDefault();

        var formData = new FormData(this);
        var formObject = {};
        formData.forEach(function(value, key){
            formObject[key] = value;
        });

        ws.send(JSON.stringify({ 'message': formObject }));
    });

    ws.onmessage = function(event) {
        var message = JSON.parse(event.data);
        console.log('Message Received from Server...', message);

        // Display the received data on the page
        var displayDiv = document.getElementById('displayData');
        displayDiv.innerHTML = `
            <h2>Received Data:</h2>
            <p>Name: ${message.message.name}</p>
            <p>Song: ${message.message.email}</p>
            
        `;
    }
</script>

</body>
</html>
